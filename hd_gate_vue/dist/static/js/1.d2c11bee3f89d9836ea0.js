webpackJsonp([1,17,18,19],{BiQ9:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var l={render:function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticStyle:{height:"100%"}},[t("el-button",{staticClass:"filter-item",attrs:{type:"success"}},[this._v("保存")]),this._v("\n  321:"+this._s(this.roleId)+"\n")],1)},staticRenderFns:[]},o=n("VU/8")({name:"menuRole",data:function(){return{}},props:["roleId"]},l,!1,null,null,null);t.default=o.exports},Fmaq:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var l=n("H1bY"),o=n("TyO7"),r=n("BiQ9"),s=n("uTVu"),a={components:{roleTable:l.default,roleMenuTree:o.default,btnRole:r.default},data:function(){return{roleId:null,activeName:"menu",checkedKeys:[]}},methods:{selRoleId:function(e){this.roleId=e},queryMenusByRoleId:function(){var e=this;this.checkedKeys=[],this.$axios.get("/hdGate/roleController/queryMenusByRoleId",{params:{roleId:this.roleId}}).then(function(t){e.checkedKeys=t},function(e){console.log("error")})}},mounted:function(){var e=this;s.a.$on("roleTablesClickedRow",function(t){e.roleId=t.roleId,e.queryMenusByRoleId()})}},i={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("el-container",[n("el-aside",{attrs:{width:"40%"}},[n("roleTable",{ref:"roleTable",on:{selRoleId:e.selRoleId}})],1),e._v(" "),n("el-main",[n("el-tabs",{model:{value:e.activeName,callback:function(t){e.activeName=t},expression:"activeName"}},[n("el-tab-pane",{attrs:{label:"菜单",name:"menu"}},["menu"==e.activeName&&e.roleId?n("role-menu-tree",{attrs:{roleId:e.roleId,checkedKeys:e.checkedKeys}}):e._e()],1)],1)],1)],1)},staticRenderFns:[]},c=n("VU/8")(a,i,!1,null,null,null);t.default=c.exports},H1bY:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var l=n("+PFJ"),o=n("uTVu"),r=[],s={components:{roleForm:l.default},data:function(){return{listLoading:!1,tableData:r,clickedRoleId:"",clickedRoleName:""}},mounted:function(){r.filter(function(e){return!0}).forEach(function(e){r.pop(e)}),this.queryAllRoles()},methods:{roleRowClick:function(e,t,n){this.clickedRoleName=e.roleName,this.clickedRoleId=e.roleId,o.a.$emit("roleTablesClickedRow",e)},addRole:function(){this.$refs.roleForm.show("add",{})},updateRole:function(e,t){"1"!==t.isAdmin&&(t.isAdmin="0"),this.$refs.roleForm.show("update",t)},deleteRole:function(){var e=this;void 0!==this.clickedRoleId?this.$confirm("此操作将永久删除“"+this.clickedRoleName+"”角色, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){e.$axios.get("/hdGate/roleController/deleteRole",{params:{roleId:e.clickedRoleId}}).then(function(e){},function(e){console.log("删除角色失败")}),location.reload()}).catch(function(){e.$message({type:"info",message:"已取消删除"})}):this.$message({type:"error",message:"请选择角色！"})},queryAllRoles:function(){this.$axios.get("/hdGate/roleController/queryAllRoles").then(function(e){e.forEach(function(e){e.edit=!1,r.push(e)})},function(e){console.log("error")})}}},a={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("el-container",[n("el-main",[n("div",{staticClass:"filter-container"},[e.hasBtnPerm("role_add")?n("el-button",{staticClass:"filter-item",attrs:{type:"primary"},on:{click:e.addRole}},[e._v("新增")]):e._e(),e._v(" "),e.hasBtnPerm("role_delete")?n("el-button",{staticClass:"filter-item",attrs:{type:"danger"},on:{click:e.deleteRole}},[e._v("删除")]):e._e()],1),e._v(" "),n("div",{style:{width:"100%"}},[n("el-table",{directives:[{name:"loading",rawName:"v-loading.body",value:e.listLoading,expression:"listLoading",modifiers:{body:!0}}],staticStyle:{width:"100%"},attrs:{data:e.tableData,stripe:"",border:"","highlight-current-row":""},on:{"row-click":e.roleRowClick}},[n("el-table-column",{attrs:{align:"center",prop:"roleName",label:"名称"}}),e._v(" "),n("el-table-column",{attrs:{align:"center",prop:"description",label:"描述"}}),e._v(" "),n("el-table-column",{attrs:{align:"center",prop:"isAdmin",label:"是否管理员"},scopedSlots:e._u([{key:"default",fn:function(t){return["1"===t.row.isAdmin?n("span",[e._v("是")]):n("span",[e._v("否")])]}}])}),e._v(" "),n("el-table-column",{attrs:{align:"center",label:"操作",fixed:"right"},scopedSlots:e._u([{key:"default",fn:function(t){return[e.hasBtnPerm("role_update")?n("el-button",{attrs:{type:"primary",size:"small",icon:"el-icon-edit"},on:{click:function(n){e.updateRole(t.$index,t.row)}}},[e._v("修改")]):e._e()]}}])})],1)],1)]),e._v(" "),n("role-form",{ref:"roleForm"})],1)},staticRenderFns:[]},i=n("VU/8")(s,a,!1,null,null,null);t.default=i.exports},TyO7:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var l={name:"rolePermTree",components:{},data:function(){return{btnsList:[{label:"",describe:"",flag:!1}],menuDatas:[{id:"",label:"",children:[]}]}},props:["roleId","checkedKeys"],methods:{searchMenu:function(){var e=this;this.$axios.get("/hdGate/sys/findAllMenusTree").then(function(t){e.menuDatas=t},function(e){console.log("error")})},roleMenuSubmit:function(){var e=this,t=this.$refs.roleMenuTree.getCheckedKeys();this.$axios.get("/hdGate/sys/updateRoleMenus",{params:{permIds:t.toString(),roleId:this.roleId}}).then(function(t){e.$message({type:"success",message:"菜单信息设置成功,请重新登录获取最新权限"}),location.reload()},function(e){console.log("error")})},showBtns:function(e){var t=this,n=this,l=e.id;n.$axios.get("/hdGate/sys/findAllBtnsByMenuId",{params:{roleId:this.roleId,menuId:l}}).then(function(e){e.map(function(e){n.$set(e,"flag",!1)}),n.$axios.get("/hdGate/sys/findBtnsByRoleAndMenuId",{params:{roleId:t.roleId,menuId:l}}).then(function(t){t.forEach(function(t){var n=t.id;e.forEach(function(e){e.id===n&&(e.flag=!0)})}),n.btnsList=e},function(e){console.log("findBtnsByRoleAndMenuId error")})},function(e){console.log("findAllBtnsByMenuId error")})},switchChange:function(e){var t=this;console.log(e),this.$axios.get("/hdGate/sys/changeRoleBtn",{params:{roleId:this.roleId,btnId:e.id,flag:e.flag}}).then(function(e){t.$message({message:"按钮授权更改成功",type:"success"})},function(e){console.log("error")})}},mounted:function(){this.searchMenu()},watch:{roleId:function(e,t){this.$refs.roleMenuTree.setCheckedKeys(this.checkedKeys),this.searchMenu()}}},o={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("el-row",[n("el-col",{attrs:{span:10}},[n("div",[e.hasBtnPerm("role_save")?n("el-button",{staticClass:"filter-item",attrs:{type:"success"},on:{click:e.roleMenuSubmit}},[e._v("保存")]):e._e(),e._v(" "),n("el-tree",{ref:"roleMenuTree",attrs:{data:e.menuDatas,"show-checkbox":"","node-key":"id","default-checked-keys":e.checkedKeys,"default-expand-all":"","highlight-current":!1,"expand-on-click-node":!1},on:{"node-click":e.showBtns}})],1)]),e._v(" "),n("el-col",{attrs:{span:14}},[e._v("\n    按钮\n    "),n("el-table",{staticStyle:{width:"100%"},attrs:{data:e.btnsList,stripe:"",border:""}},[n("el-table-column",{attrs:{align:"center",prop:"label",label:"名称"}}),e._v(" "),n("el-table-column",{attrs:{align:"center",prop:"describe",label:"描述"}}),e._v(" "),e.hasBtnPerm("role_btn_change")?n("el-table-column",{attrs:{align:"center",label:"是否赋权",fixed:"right"},scopedSlots:e._u([{key:"default",fn:function(t){return[n("el-switch",{attrs:{"active-color":"#13ce66","inactive-color":"#ff4949"},on:{change:function(n){e.switchChange(t.row)}},model:{value:t.row.flag,callback:function(n){e.$set(t.row,"flag",n)},expression:"scope.row.flag"}})]}}])}):e._e()],1)],1)],1)},staticRenderFns:[]},r=n("VU/8")(l,o,!1,null,null,null);t.default=r.exports}});