webpackJsonp([14],{l2Gg:function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=s("uTVu"),a=[],r={components:{userForm:s("wa/K").default},data:function(){return{listLoading:!1,tableData:a,flag:!1,parentDept:{deptId:""}}},mounted:function(){var e=this;n.a.$on("usersClickedDeptId",function(t){e.queryUsersByDeptId(t.deptId),this.listLoading=!1,e.flag=!0,e.parentDept=t})},methods:{addUser:function(){this.flag?this.$refs.userForm.show("add",this.parentDept):this.$message({type:"error",message:"请选择部门！"})},updateUser:function(e,t){this.$refs.userForm.show("update",t)},deleteUser:function(e,t){var s=this;if(this.flag){var n="dept",a=this.parentDept.label+"”部门下的所有用户信息";e>=0&&(n="user",a=t.userName+"”该用户"),this.$confirm("此操作将永久删除“"+a+"”, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){console.log("ssssssssssssssss",t,s.parentDept),void 0===t?s.$axios.get("/hdGate/userController/deleteUser",{params:{flag:n,account:"",parentDeptId:s.parentDept.deptId}}).then(function(e){console.log("delete dept success"),location.reload()},function(e){console.log("删除部门失败")}):"admin"===t.account?s.$message("该用户无法删除"):s.$axios.get("/hdGate/userController/deleteUser",{params:{flag:n,account:t.account,parentDeptId:s.parentDept.deptId}}).then(function(e){console.log("delete dept success"),location.reload()},function(e){console.log("删除部门失败")})}).catch(function(){s.$message({type:"info",message:"已取消删除"})})}else this.$message({type:"error",message:"请选择部门！"})},queryUsersByDeptId:function(e){this.$axios.get("/hdGate/userController/queryUsersByDeptId",{params:{deptId:e}}).then(function(e){a.filter(function(e){return!0}).forEach(function(e){a.pop(e)}),e.forEach(function(e){e.edit=!1,a.push(e)})},function(e){console.log("error")})}}},o={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("el-container",[s("el-main",[s("div",{staticClass:"filter-container"},[s("el-row",[s("el-col",{attrs:{span:4}},[s("h2",{staticStyle:{"margin-top":"0px"}},[e._v("用户管理:")])]),e._v(" "),s("el-col",{attrs:{span:20}},[e.hasBtnPerm("user_add")?s("el-button",{staticClass:"filter-item",attrs:{type:"primary"},on:{click:e.addUser}},[e._v("新增")]):e._e(),e._v(" "),e.hasBtnPerm("user_delete_dept")?s("el-button",{staticClass:"filter-item",attrs:{type:"danger"},on:{click:e.deleteUser}},[e._v("删除")]):e._e()],1)],1)],1),e._v(" "),s("div",{style:{width:"100%"}},[s("el-table",{directives:[{name:"loading",rawName:"v-loading.body",value:e.listLoading,expression:"listLoading",modifiers:{body:!0}}],staticStyle:{width:"100%"},attrs:{data:e.tableData,stripe:"",border:""}},[s("el-table-column",{attrs:{align:"center",prop:"userName",label:"名称"}}),e._v(" "),s("el-table-column",{attrs:{align:"center",prop:"orgnId",label:"部门id"}}),e._v(" "),s("el-table-column",{attrs:{align:"center",prop:"account",label:"登录账号"}}),e._v(" "),s("el-table-column",{staticStyle:{width:"100px"},attrs:{align:"center",label:"操作",fixed:"right"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("el-row",[s("el-col",{attrs:{lg:12}},[e.hasBtnPerm("user_update")?s("el-button",{attrs:{type:"primary",size:"small",icon:"el-icon-edit"},on:{click:function(s){e.updateUser(t.$index,t.row)}}},[e._v("修改")]):e._e()],1),e._v(" "),s("el-col",{attrs:{lg:12}},[e.hasBtnPerm("user_delete")?s("el-button",{attrs:{type:"warning",size:"small",icon:"el-icon-delete"},on:{click:function(s){e.deleteUser(t.$index,t.row)}}},[e._v("删除")]):e._e()],1)],1)]}}])})],1)],1)]),e._v(" "),s("user-form",{ref:"userForm"})],1)},staticRenderFns:[]},l=s("VU/8")(r,o,!1,null,null,null);t.default=l.exports}});