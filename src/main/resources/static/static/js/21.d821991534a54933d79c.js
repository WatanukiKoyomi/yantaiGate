webpackJsonp([21],{GjWk:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=a("mvHQ"),l=a.n(n),s=a("uTVu"),o=[{deptId:"",label:"",children:[]}],r={components:{deptForm:a("vymf").default},data:function(){return{listLoading:!1,tableData:o,flag:!1,parentDept:{}}},mounted:function(){var e=this;s.a.$on("clickedDeptId",function(t){o.filter(function(e){return!0}).forEach(function(e){o.pop(e)}),null!==t.children&&t.children.forEach(function(e){e.edit=!1,o.push(e)}),e.listLoading=!1,e.flag=!0,e.parentDept=t})},methods:{addDept:function(){this.flag?this.$refs.deptForm.show("add",this.parentDept):this.$message({type:"error",message:"请选择部门！"})},updateDept:function(e,t){console.log("updateDept",e),console.log("updateDept",t),this.$refs.deptForm.show("update",t)},updateDeptName:function(e,t){this.flag?(console.log("index:",e),console.log(this.parentDept),this.$refs.deptForm.show("update",this.parentDept)):this.$message({type:"error",message:"请选择部门！"})},deleteDept:function(e,t){var a=this;this.flag?"1"===this.parentDept.deptId?this.$message({type:"warning",message:"该部门为根部门，不能删除，如有需要请选择修改"}):this.$confirm("此操作将永久删除“"+this.parentDept.label+"”部门及其部门下的所有子部门,及其部门下的所有用户, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){var e=l()(a.parentDept);console.log("aaa:",a.parentDept,e),a.parentDept.children=null,a.$axios.get("/hdGate/deptController/deleteDept",{params:{parentDept:a.parentDept}}).then(function(e){console.log("delete dept success")},function(e){console.log("删除部门失败")}),location.reload()}).catch(function(){a.$message({type:"info",message:"已取消删除"})}):this.$message({type:"error",message:"请选择部门！"})}}},i={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-container",[a("el-main",[a("div",{staticClass:"filter-container"},[a("el-row",[a("el-col",{attrs:{span:4}},[a("h2",{staticStyle:{"margin-top":"0px"}},[e._v("部门管理:")])]),e._v(" "),a("el-col",{attrs:{span:20}},[e.hasBtnPerm("dept_add")?a("el-button",{staticClass:"filter-item",attrs:{type:"primary"},on:{click:e.addDept}},[e._v("新增")]):e._e(),e._v(" "),e.hasBtnPerm("dept_delete")?a("el-button",{staticClass:"filter-item",attrs:{type:"danger"},on:{click:e.deleteDept}},[e._v("删除")]):e._e(),e._v(" "),e.hasBtnPerm("dept_update")?a("el-button",{staticClass:"filter-item",attrs:{type:"warning"},on:{click:e.updateDeptName}},[e._v("修改")]):e._e()],1)],1)],1),e._v(" "),a("div",{style:{width:"100%"}},[a("el-table",{directives:[{name:"loading",rawName:"v-loading.body",value:e.listLoading,expression:"listLoading",modifiers:{body:!0}}],staticStyle:{width:"100%"},attrs:{data:e.tableData,stripe:"",border:""}},[a("el-table-column",{attrs:{align:"center",prop:"label",label:"名称"},scopedSlots:e._u([{key:"default",fn:function(t){return[t.row.edit?[a("el-input",{staticClass:"edit-input",attrs:{size:"small"},model:{value:t.row.label,callback:function(a){e.$set(t.row,"label",a)},expression:"scope.row.label"}})]:a("span",[e._v(e._s(t.row.label))])]}}])}),e._v(" "),a("el-table-column",{attrs:{align:"center",prop:"deptEnName",label:"英文名称"}}),e._v(" "),a("el-table-column",{attrs:{align:"center",prop:"deptShortName",label:"名称简写"}}),e._v(" "),a("el-table-column",{attrs:{align:"center",prop:"sortNo",label:"排列序号"}}),e._v(" "),a("el-table-column",{attrs:{align:"center",label:"操作",fixed:"right"},scopedSlots:e._u([{key:"default",fn:function(t){return[e.hasBtnPerm("dept_update")?a("el-button",{attrs:{type:"primary",size:"small",icon:"el-icon-edit"},on:{click:function(a){e.updateDept(t.$index,t.row)}}},[e._v("修改")]):e._e()]}}])})],1)],1)]),e._v(" "),a("dept-form",{ref:"deptForm"})],1)},staticRenderFns:[]},p=a("VU/8")(r,i,!1,null,null,null);t.default=p.exports}});