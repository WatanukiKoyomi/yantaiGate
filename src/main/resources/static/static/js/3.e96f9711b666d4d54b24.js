webpackJsonp([3,13,14],{"3omw":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=n("8jtQ"),r=n("l2Gg"),a={components:{usersDeptTree:s.default,userTable:r.default},data:function(){return{}},methods:{change:function(e){}}},l={render:function(){var e=this.$createElement,t=this._self._c||e;return t("el-container",{staticStyle:{height:"100%"}},[t("el-aside",{staticStyle:{height:"100%"}},[t("users-dept-tree",{ref:"usersDeptTree"})],1),this._v(" "),t("el-main",[t("user-table",{ref:"userTable",on:{change:this.change}})],1)],1)},staticRenderFns:[]},o=n("VU/8")(a,l,!1,null,null,null);t.default=o.exports},"8jtQ":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=n("uTVu"),r={data:function(){return{deptDatas:[{deptId:"",label:"",children:[]}]}},methods:{searchDept:function(){var e=this,t=JSON.parse(sessionStorage.user).username;this.$axios.get("/hdGate/deptController/queryDeptsByAccount",{params:{username:t}}).then(function(t){e.deptDatas=t},function(e){console.log("error")})},sendMsg:function(e,t){s.a.$emit("usersClickedDeptId",e)}},mounted:function(){this.searchDept()}},a={render:function(){var e=this.$createElement;return(this._self._c||e)("el-tree",{staticStyle:{height:"100%"},attrs:{data:this.deptDatas,"node-key":"deptId","default-expand-all":"","highlight-current":!0,"expand-on-click-node":!1},on:{"node-click":this.sendMsg}})},staticRenderFns:[]};var l=n("VU/8")(r,a,!1,function(e){n("OQly")},null,null);t.default=l.exports},OQly:function(e,t){},l2Gg:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=n("uTVu"),r=[],a={components:{userForm:n("wa/K").default},data:function(){return{listLoading:!1,tableData:r,flag:!1,parentDept:{deptId:""}}},mounted:function(){var e=this;s.a.$on("usersClickedDeptId",function(t){e.queryUsersByDeptId(t.deptId),this.listLoading=!1,e.flag=!0,e.parentDept=t})},methods:{addUser:function(){this.flag?this.$refs.userForm.show("add",this.parentDept):this.$message({type:"error",message:"请选择部门！"})},updateUser:function(e,t){this.$refs.userForm.show("update",t)},deleteUser:function(e,t){var n=this;if(this.flag){var s="dept",r=this.parentDept.label+"”部门下的所有用户信息";e>=0&&(s="user",r=t.userName+"”该用户"),this.$confirm("此操作将永久删除“"+r+"”, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){console.log("ssssssssssssssss",t,n.parentDept),void 0===t?n.$axios.get("/hdGate/userController/deleteUser",{params:{flag:s,account:"",parentDeptId:n.parentDept.deptId}}).then(function(e){console.log("delete dept success"),location.reload()},function(e){console.log("删除部门失败")}):"admin"===t.account?n.$message("该用户无法删除"):n.$axios.get("/hdGate/userController/deleteUser",{params:{flag:s,account:t.account,parentDeptId:n.parentDept.deptId}}).then(function(e){console.log("delete dept success"),location.reload()},function(e){console.log("删除部门失败")})}).catch(function(){n.$message({type:"info",message:"已取消删除"})})}else this.$message({type:"error",message:"请选择部门！"})},queryUsersByDeptId:function(e){this.$axios.get("/hdGate/userController/queryUsersByDeptId",{params:{deptId:e}}).then(function(e){r.filter(function(e){return!0}).forEach(function(e){r.pop(e)}),e.forEach(function(e){e.edit=!1,r.push(e)})},function(e){console.log("error")})}}},l={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("el-container",[n("el-main",[n("div",{staticClass:"filter-container"},[n("el-row",[n("el-col",{attrs:{span:4}},[n("h2",{staticStyle:{"margin-top":"0px"}},[e._v("用户管理:")])]),e._v(" "),n("el-col",{attrs:{span:20}},[e.hasBtnPerm("user_add")?n("el-button",{staticClass:"filter-item",attrs:{type:"primary"},on:{click:e.addUser}},[e._v("新增")]):e._e(),e._v(" "),e.hasBtnPerm("user_delete_dept")?n("el-button",{staticClass:"filter-item",attrs:{type:"danger"},on:{click:e.deleteUser}},[e._v("删除")]):e._e()],1)],1)],1),e._v(" "),n("div",{style:{width:"100%"}},[n("el-table",{directives:[{name:"loading",rawName:"v-loading.body",value:e.listLoading,expression:"listLoading",modifiers:{body:!0}}],staticStyle:{width:"100%"},attrs:{data:e.tableData,stripe:"",border:""}},[n("el-table-column",{attrs:{align:"center",prop:"userName",label:"名称"}}),e._v(" "),n("el-table-column",{attrs:{align:"center",prop:"orgnId",label:"部门id"}}),e._v(" "),n("el-table-column",{attrs:{align:"center",prop:"account",label:"登录账号"}}),e._v(" "),n("el-table-column",{staticStyle:{width:"100px"},attrs:{align:"center",label:"操作",fixed:"right"},scopedSlots:e._u([{key:"default",fn:function(t){return[n("el-row",[n("el-col",{attrs:{lg:12}},[e.hasBtnPerm("user_update")?n("el-button",{attrs:{type:"primary",size:"small",icon:"el-icon-edit"},on:{click:function(n){e.updateUser(t.$index,t.row)}}},[e._v("修改")]):e._e()],1),e._v(" "),n("el-col",{attrs:{lg:12}},[e.hasBtnPerm("user_delete")?n("el-button",{attrs:{type:"warning",size:"small",icon:"el-icon-delete"},on:{click:function(n){e.deleteUser(t.$index,t.row)}}},[e._v("删除")]):e._e()],1)],1)]}}])})],1)],1)]),e._v(" "),n("user-form",{ref:"userForm"})],1)},staticRenderFns:[]},o=n("VU/8")(a,l,!1,null,null,null);t.default=o.exports}});